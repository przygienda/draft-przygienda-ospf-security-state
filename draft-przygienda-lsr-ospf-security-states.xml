<?xml version='1.0' encoding='utf-8'?>
<!DOCTYPE rfc [
        <!ENTITY nbsp    "&#160;">
        <!ENTITY zwsp   "&#8203;">
        <!ENTITY nbhy   "&#8209;">
        <!ENTITY wj     "&#8288;">
        ]>
<?rfc toc="yes"?>
<?rfc tocompact="yes"?>
<?rfc tocdepth="3"?>
<?rfc tocindent="yes"?>
<?rfc symrefs="yes"?>
<?rfc sortrefs="yes"?>
<?rfc comments="no"?>
<?rfc inline="yes"?>
<?rfc compact="yes"?>
<?rfc subcompact="no"?>
<rfc xmlns:xi="http://www.w3.org/2001/XInclude" category="exp" docName="draft-przygienda-lsr-ospf-security-states-00" ipr="trust200902" obsoletes=""
     submissionType="IETF" updates="" xml:lang="en" tocInclude="true" tocDepth="3" symRefs="true" sortRefs="true" version="3">
    <!-- xml2rfc v2v3 conversion 3.9.1 -->
    <front>
        <title abbrev="OSPF/ISIS Link/Node Security Advertisement">
            Advertising Link and Node Security Properties in OSPF/IS-IS
        </title>
        <seriesInfo name="Internet-Draft" value="draft-przygienda-lsr-ospf-security-states-00"/>
        <author fullname="Tony Przygienda" initials="A." surname="Przygienda" role="editor">
            <organization>Juniper</organization>
            <address>
                <postal>
                    <street>1137 Innovation Way
                    </street>
                    <city>Sunnyvale</city>
                    <region>CA
                    </region>
                    <code/>
                    <country>USA
                    </country>
                </postal>
                <phone/>
                <email>prz@juniper.net
                </email>
                <uri/>
            </address>
        </author>

        <author fullname="Acee Lindem" initials="A." surname="Lindem" role="editor">
            <organization>LabN Networks, L.L.C.</organization>
            <address>
                <postal>
                    <street>301 Midenhall Way</street>
                    <city>Cary</city>
                    <region>NC
                    </region>
                    <code/>
                    <country>USA
                    </country>
                </postal>
                <phone/>
                <email>acee.ietf@gmail.com
                </email>
                <uri/>
            </address>
        </author>

        <author fullname="Vinayaka Guntanakkala" initials="G." surname="Guntanakkala">
            <organization showOnFrontPage="true">Juniper Networks</organization>
            <address>
                <postal>
                    <country>India</country>
                </postal>
                <email>vinayakag@juniper.net</email>
            </address>
        </author>

        <date year="2023"/>
        <abstract>
            <t>
                This document defines a way for an Open Shortest Path First (OSPF) 
		and Intermediate System to Intermediate System (IS-IS) router to 
		advertise different security states at node and/or link granularity.
		Such advertisements allow entities (e.g., centralized controllers)
		to e.g. determine whether a particular node/link or path meets 
		security policies that have to be enforced. Here, the term
		"OSPF" means both OSPFv2 and OSPFv3.
            </t>
        </abstract>
        <note>
            <name>Requirements Language</name>
            <t>
                The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
                "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and
                "OPTIONAL" in this document are to be interpreted as described in BCP
                14 <xref target="RFC2119" format="default"/> <xref target="RFC8174" format="default"/> when, and only when, they appear in all
                capitals, as shown here.
            </t>
        </note>
    </front>
    <middle>

        <section toc="default" numbered="true">
            <name>Introduction</name>
            <t>OSPF/ISIS, as an IGP, is one of the most critical protocols in a network and compromising integrity of any
            of its nodes by a misconfiguration or security attack can have catastrophic consequences. Though
            infrastructure can be deployed to monitor and alarm changes in security status of OSPF/ISIS nodes it is
            desirable for a mechanism that allows fastest and completely non-ambigous detection of any
            security state change of OSPF/ISIS nodes or links, indepenent of e.g. status of a monitoring connection or
            implementation defect in any piece of the monitoring infrastructure or ultimately, successful attacks
            against such infrastructure. Link state database is in its nature ideally suited to carry such information given
            that it is not only a very fast mechanism due to the nature of flooding but also represents
            the ultimate source of truth in terms of topology state and thus security state.
	    The use case is to build paths through most secure links by using Flex algorithm.
            </t>
        </section>

        <section anchor="glossary" numbered="true" toc="default">
            <name>Glossary</name>
            <t>
                The following terms are used in this document.
            </t>
            <dl newline="true" spacing="normal">
                <dt>OSPF:</dt>
                <dd>
                    Open Shortest Path First
                </dd>
                <dt>ISIS:</dt>
                <dd>
                    Intermediate System to Intermediate System
                </dd>
                <dt>LSA:</dt>
                <dd>
                    Link State Advertisement
                </dd>
                <dt>RI:</dt>
                <dd>
                    Router Information
                </dd>
                 <dt>NSI:</dt>
                <dd>
                    Node Security Information
                </dd> 
                 <dt>LSI:</dt>
                <dd>
                    Link Security Information
                </dd>
                 <dt>sec-property:</dt>
                <dd>
                    single property of link representing something like .e.g. macsec, sha-2 type with key-id,
		    we denote as p and  ]P is the space of all possible p values and p can represent any of the CIA triad.
                </dd> 
                 <dt>sec-property-vector:</dt>
                <dd>
                    sec-property-vector: is a ordered set of p \elem_of ]P. 
		    (which implies basically that ]P must be a total order) 
                </dd> 
                 <dt>null:</dt>
                <dd>
                    element of ]P that signifies security property that provides no security aspect. Can be omitted, 
		    i.e. is implicit. we need that to compare sec-property-vectors of different length.
                </dd> 
                 <dt>R:</dt>
                <dd>
                    ]R is the set of all possible sec-property-vectors. 
		    if we denote a sec-property-vector as V we can say ]R is the space of all possible Vs.
		    R is a total order.
                </dd>  
            </dl>
        </section>

        <section numbered="true" toc="default">
            <name>Forwarding Considerations</name>
            <t></t>

        </section>


        <section anchor="node_sec" numbered="true" toc="default">
            <name>Node Security Information Advertisement</name>
            <t>
                OSPF
                The Node Security Information TLV within the body of the OSPF RI Opaque LSA
                <xref target="RFC7770" format="default"/> is used to advertise current node security states.
            </t>

            <t>
            This TLV is optional and is applicable to both OSPFv2 and OSPFv3.
            The scope of the advertisement is specific to the deployment.
            </t>
            <t>
            When multiple Node Security Information TLVs are received from a given router, the
            receiver MUST use the first occurrence of the TLV in the Router
            Information (RI) LSA.  If the Node Security Infomation TLV appears in multiple RI
            LSAs that have different flooding scopes, the Node Security Information TLV in the RI
            LSA with the area-scoped flooding scope MUST be used.  If the Node
            Security Information TLV appears in multiple RI LSAs that have the same flooding
            scope, the Node Security Information TLV in the RI LSA with the numerically smallest
            Instance ID MUST be used and other instances of the Node Security Information TLV MUST
            be ignored.  The RI LSA can be advertised at any of the defined
            opaque flooding scopes (link, area, or Autonomous System (AS)).  For
            the purpose of Node Security Information TLV advertisement, area-scoped flooding is
            RECOMMENDED.
            </t>

            <figure anchor="f1">
                <name>Node Security Information TLV</name>
                <artwork align="left" alt="" name="" type=""><![CDATA[
   0                   1                   2                   3
   0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |    Type                       |  Length                       |
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |             Sec-Type          |           Sec-Value           |
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    ]]></artwork>
            </figure>
            <t>where:</t>
            <dl newline="false" spacing="normal">
	
            <dt>Type:</dt>
            <dd>For OSPFv2, the Node security information is advertised as an optional
                TLV of the OSPFv2 Router Information LSA as defined in section 2.1 of
                <xref target="RFC7770" format="default"/>
                and has a type of ?.

                For OSPFv3, the Node security information is advertised as an optional
                TLV of the OSPFv3 Router Information LSA as defined in section 2.2 of
                <xref target="RFC7770" format="default"/>
                and has a
                type of ?.</dd>
            <dt>Length:</dt>
                <dd>variable; same as defined in Section ?.</dd>
                <dt>Value:</dt>
                <dd>Sec-type represents the mechanism by which Node is secured and 
                    Sec-value represents the value associated
                    For example Node is secured using MD5 with key-id '2'.
                    
                    Currently OSPF supports authentication like simple password,
                    keyed MD5, HMAC-SHA/SHA2/SHA3, IPSec etc.
                
                    If there are multiple security layers available in the path then 
                    OSPF can advertise the most secure available in the path in 
                    its Node security Information</dd>
        
            </dl>

            <t>
               This TLV is optional.  The scope of the advertisement is specific
               to the deployment.
            </t>
            <t>
                ISIS
                The Node Security Information sub-TLV is defined within the body of the IS-IS Router
                CAPABILITY TLV <xref target="RFC7981" format="default"/> to carry the Node security
		Information available of the router originating the IS-IS Router CAPABILITY TLV. 
            </t>

            <figure anchor="f2">
                <name>Node Security Information Sub-TLV</name>
                <artwork align="left" alt="" name="" type=""><![CDATA[
    0                   1
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5

    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |    Type       |   Length      |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |            Sec-Type           |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |            Sec-Value          |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    ]]></artwork>
            </figure>
            <t>where:</t>
            <dl newline="false" spacing="normal">
	
            <dt>Type:</dt>
            <dd>TBD</dd>
            <dt>Length:</dt>
                <dd>variable; same as defined in Section ?.</dd>
                <dt>Value:</dt>
                <dd>Sec-type represents the mechanism by which Node is secured and 
                    Sec-value represents the value associated
                    For example Node is secured using MD5 with key-id '2'.
                    
                    Currently ISIS supports authentication like HMAC MD5, SHA1, HMAC-SHA1/SHA2/SHA3 etc.
                
                    If there are multiple security layers available in the path then 
                    ISIS can advertise the most secure available in the path in 
                    its Node security Information Sub-TLV
		    This sub-TLV is optional.</dd>
        
            </dl>
		
        </section>


        <section anchor="link_sec" numbered="true" toc="default">
            <name>Link Security Information Advertisement</name>
            <t>
		OSPF    
                The Link Security Information sub-TLV is defined to carry the security state of the interface
                associated with the link.
            </t>

            <figure anchor="f3">
                <name>Link Security Information Sub-TLV</name>
                <artwork align="left" alt="" name="" type=""><![CDATA[
   0                   1                   2                   3
   0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |    Type                       |  Length                       |
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |             Sec-Type          |           Sec-Value           |
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    ]]></artwork>
            </figure>

            <dl newline="false" spacing="normal">
            <dt>Type:</dt>
            <dd>For OSPFv2, the link-level security information is advertised as an optional
                sub-TLV of the OSPFv2 Extended Link TLV as defined in
                <xref target="RFC7684" format="default"/>
                and has a type of ?.

                For OSPFv3, the link-level security information is advertised as an optional
                sub-TLV of the E-Router-LSA TLV as defined in
                <xref target="RFC8362" format="default"/>
                and has a
                type of ?.</dd>
            <dt>Length:</dt>
                <dd>variable; same as defined in Section ?.</dd>
                <dt>Value:</dt>
                <dd>Sec-type represents the mechanism by which Link is secured and 
                    Sec-value represents the value associated
                    For example link is secured using MD5 with key-id '2'.
                    
                    Currently OSPF supports authentication like simple password,
                    keyed MD5, HMAC-SHA/SHA2/SHA3, IPSec etc.
                
                    If there are multiple security layers available in the path then 
                    OSPF can advertise the most secure available in the path in 
                    its Link security Information</dd>
            </dl>

            <t>

            If this sub-TLV is advertised multiple times for the same link in
            different OSPF Extended Link Opaque LSAs / E-Router-LSAs originated
            by the same OSPF router, the sub-TLV in the OSPFv2 Extended Link
            Opaque LSA with the smallest Opaque ID or in the OSPFv3 E-Router-LSA
            with the smallest Link State ID MUST be used by receiving OSPF
            routers.  This situation SHOULD be logged as an error.
            </t>
            <t>
             This sub-TLV is optional. The scope of the advertisement is specific
             to the deployment.
            </t>

            <t>
		ISIS    
                The Link Security Information sub-TLV is defined to carry the security state of the interface
                associated with the link.
		The Link Security Information sub-TLV is defined for TLVs 22, 23, 25, 141, 222, and
                223 to carry the Link Security Information of the interface associated with the link.
            </t>

            <figure anchor="f4">
                <name>Link Security Information Sub-TLV</name>
                <artwork align="left" alt="" name="" type=""><![CDATA[
    0                   1
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5

    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |    Type       |   Length      |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |            Sec-Type           |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |            Sec-Value          |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    ]]></artwork>
            </figure>

            <dl newline="false" spacing="normal">
            <dt>Type:</dt>
            <dd>TBD</dd>
            <dt>Length:</dt>
                <dd>variable; same as defined in Section ?.</dd>
                <dt>Value:</dt>
                <dd>Sec-type represents the mechanism by which the Link is secured and 
                    Sec-value represents the value associated
                    For example Link is secured using MD5 with key-id '2'.
                    
                    Currently ISIS supports authentication like HMAC MD5, SHA1, HMAC-SHA1/SHA2/SHA3 etc.
                
                    If there are multiple security layers available in the path then 
                    ISIS can advertise the most secure available in the path in 
                    its Link security Information Sub-TLV.
		    This sub-TLV is optional. </dd>
        
            </dl>

		
        <section numbered="true" toc="default">
            <name>Procedures for Defining and Using Node and Link Security Information Advertisements</name>
            <t>
                When Link Security Information is present for a given Router, the value of the Link
                Security Information MUST take precedence over the Node security information.  If a Link Security_Information-Type is
                not signaled, but the Node Security_Information-Type is, then the Node Security_Information-Type value
                MUST be considered to be the Security Information value for that link.
            </t>
        </section>
        </section>
        <section anchor="IANA" toc="default" numbered="true">
            <name>IANA Considerations</name>
            <t>This document requests allocation for the following codepoints.</t>
            <t>...</t>
        </section>
        <section numbered="true" toc="default">
            <name>Security Considerations</name>
            <t>
            Security concerns for OSPF are addressed in
                <xref target="RFC7474" format="default"/>,
                <xref target="RFC4552" format="default"/>, and
                <xref target="RFC7166" format="default"/>.
                Further security analysis for the OSPF protocol is done
            in
                <xref target="RFC6863" format="default"/>.
                Security considerations as specified by
                <xref target="RFC7770" format="default"/>,
                <xref target="RFC7684" format="default"/>, and
                <xref target="RFC8362" format="default"/> are applicable to this document.
            </t>

            <t>
            Implementations MUST ensure that malformed TLVs and sub-TLVs defined
            in this document are detected and do not provide a vulnerability for
            attackers to crash the OSPF router or routing process.  Reception of
            malformed TLVs or sub-TLVs SHOULD be counted and/or logged for
            further analysis.  Logging of malformed TLVs and sub-TLVs SHOULD be
            rate-limited to prevent a Denial-of-Service (DoS) attack (distributed
            or otherwise) from overloading the OSPF control plane.
            </t>

            <t>
            Advertisement of an incorrect security information may have negative
            consequences if e.g. actions like node sequestration are performed
                based on this information.
            </t>

            <t>
            There's no DoS risk specific to this extension, and it is not
            vulnerable to replay attacks.
            </t>

            <t>
                The presence of this information may also inform an attacker about
                vulnerable points in the network.
            </t>
        </section>
        <section numbered="true" toc="default">
            <name>Acknowledgements</name>
            <t>
            </t>
        </section>
    </middle>
    <back>
        <references>
            <name>References</name>
            <references> <name>Informative References</name>
            </references>
            <references>
                <name>Normative References</name>
                <xi:include href="https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.7474.xml"/>
                <xi:include href="https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.4552.xml"/>
                <xi:include href="https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.7166.xml"/>
                <xi:include href="https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.6863.xml"/>
                <xi:include href="https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.7770.xml"/>
                <xi:include href="https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.7684.xml"/>
                <xi:include href="https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.8362.xml"/>
		<xi:include href="https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.7981.xml"/>

                <xi:include href="https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.2119.xml"/>
                <xi:include href="https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.8174.xml"/>
              </references>
        </references>
    </back>
</rfc>
